(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{HV9d:function(e,t,a){"use strict";var r=a("TqRt"),n=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("g9YV");var l=r(a("wCAj"));a("IzEo");var i=r(a("bx4M"));a("14J3");var d=r(a("BMrR"));a("jCWc");var u=r(a("kPKH")),o=r(a("lSNA")),f=r(a("MVZn")),p=r(a("lwsE")),s=r(a("W8MJ")),c=r(a("a1gu")),h=r(a("Nsbk")),y=r(a("7W2i"));a("sRBo");var m,g,v=r(a("kaz8")),E=n(a("q1tI")),I=r(a("wd/R")),q=a("MuoO"),b=r(a("zHco")),D=r(a("qrxk")),R=r(a("S4++")),k=v.default.Group,w=(m=(0,q.connect)(function(e){var t=e.report,a=e.field,r=e.airport,n=e.loading;return{query:t.query,reports:t.currentReports,pagination:t.pagination,history:t.history,fields:a.current,fieldMap:a.map,airports:r.list,loading:n.effects["report/queryCurrent"]||n.effects["field/queryCurrent"]||n.effects["airport/queryAll"]}}),m(g=function(e){function t(e){var a;return(0,p.default)(this,t),a=(0,c.default)(this,(0,h.default)(t).call(this,e)),a.pageDispatch=function(e,t){var r=a.props,n=r.pagination,l=r.query,i=r.dispatch;i({type:"report/queryHistory",payload:{query:(0,f.default)({},l),pagination:(0,f.default)({},n,(0,o.default)({},e,t))}})},a.handlePageChange=function(e){a.pageDispatch("current",e)},a.handlePageSizeChange=function(e,t){a.pageDispatch("pageSize",t)},a.handleSearch=function(e){var t=a.props,r=t.dispatch,n=t.pagination;r({type:"report/queryHistory",payload:{query:(0,f.default)({},e),pagination:(0,f.default)({},n,{current:1})}})},a.handleFormReset=function(){var e=a.props,t=e.pagination,r=e.dispatch;r({type:"report/queryHistory",payload:{query:{airportId:0,reportId:[],beginDate:null,endDate:null},pagination:(0,f.default)({},t,{current:1})}})},a.handleEditItem=function(e){var t=a.props,r=t.dispatch,n=t.query;n.reportId&&n.airportId&&r({type:"report/jump2editValue",payload:{origin:(0,f.default)({},e),reportId:n.reportId,airportId:n.airportId}})},a.fileterFields=function(e){a.setState({selectedFields:e})},a.renderFieldValue=function(e){return e?E.default.createElement("span",{style:{color:"Timeout"===e.state?"#ceb311":""}},e.value):0},a.state={fields:[],selectedFields:[]},a}return(0,y.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.pagination,a=e.reports,r=e.query,n=e.airports,l=e.fields,i=e.dispatch;a.length||i({type:"report/queryCurrent"}),n.length||i({type:"airport/queryAll"}),l.length||i({type:"field/queryCurrent"}),i({type:"report/queryHistory",payload:{query:r,pagination:(0,f.default)({},t,{current:1})}})}},{key:"componentWillReceiveProps",value:function(e){if("query"in e&&e.query.reportId&&e.query.reportId.length){var t=[],a=[];e.query.reportId.forEach(function(r){var n=e.reports.find(function(e){return e.id===r});n&&e.fields.filter(function(e){return n.fields.find(function(t){return e.id===t})&&!t.find(function(t){return t.id===e.id})}).forEach(function(e){t.push((0,f.default)({},e,{label:e.name,value:e.id})),a.push(e.id)})}),this.setState({fields:t,selectedFields:a})}else if("fields"in e){var r=[],n=[];r=e.fields.map(function(e){return n.push(e.id),(0,f.default)({},e,{label:e.name,value:e.id})}),this.setState({fields:r,selectedFields:n})}}},{key:"render",value:function(){var e=this,t=this.props,a=t.history,r=t.pagination,n=t.loading,o=t.query,p=t.reports,s=t.airports,c=this.state,h=c.fields,y=c.selectedFields,m=(0,f.default)({onShowSizeChange:this.handlePageSizeChange,onChange:this.handlePageChange},r),g=0,q=[{title:"\u5f55\u5165\u65e5\u671f",dataIndex:"addDay",width:120,fixed:y.length>11&&"left",render:function(e){return e&&E.default.createElement("span",null,(0,I.default)(e).format("YYYY-MM-DD"))}}];g+=100,q=q.concat(y.map(function(t){var a=h.find(function(e){return e.id===t}),r=15*a.name.length;return r=r<80?80:r,g+=r,{title:a.name,dataIndex:a.id,width:r,render:e.renderFieldValue}})),o&&o.reportId&&1===o.reportId.length&&o.airportId&&(q.push({title:"\u64cd\u4f5c",width:80,fixed:y.length>11&&"right",render:function(t){return E.default.createElement("a",{style:{marginRight:"10px"},onClick:function(){e.handleEditItem(t)}},"\u4fee\u6539")}}),g+=80);var w=a.map(function(e){var t=e.addDay,a=e.values,r={addDay:t};return a.forEach(function(e){r[e.fieldId]?(r[e.fieldId].value+=e.value,r[e.fieldId].no+=1):(r[e.fieldId]=(0,f.default)({},e),r[e.fieldId].no=0)}),r});return E.default.createElement(b.default,{content:E.default.createElement(R.default,{query:o,reports:p,airports:s,onSearch:this.handleSearch,onReset:this.handleFormReset})},E.default.createElement(i.default,{loading:n},E.default.createElement(k,{value:y,onChange:this.fileterFields},E.default.createElement(d.default,null,h.map(function(e){return E.default.createElement(u.default,{span:4,key:e.id},E.default.createElement(v.default,{key:e.id,value:e.id},e.name))})))),E.default.createElement(i.default,{bordered:!1},E.default.createElement("div",{className:D.default.tableList},E.default.createElement(l.default,{size:"middle",bordered:!0,scroll:y.length>11?{x:g}:{},rowKey:"addDay",loading:n,pagination:m,columns:q,dataSource:w}))))}}]),t}(E.PureComponent))||g),C=w;t.default=C},"S4++":function(e,t,a){"use strict";var r=a("TqRt"),n=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("+L6B");var l=r(a("2/Rp"));a("14J3");var i=r(a("BMrR"));a("jCWc");var d=r(a("kPKH")),u=r(a("lwsE")),o=r(a("W8MJ")),f=r(a("a1gu")),p=r(a("Nsbk")),s=r(a("7W2i"));a("OaEy");var c=r(a("2fM7"));a("y8nQ");var h=r(a("Vl3Y"));a("iQDF");var y,m,g=r(a("+eQT")),v=n(a("q1tI")),E=a("Qyje"),I=g.default.RangePicker,q=h.default.Item,b=c.default.Option,D=(y=h.default.create(),y(m=function(e){function t(){var e,a;(0,u.default)(this,t);for(var r=arguments.length,n=new Array(r),l=0;l<r;l++)n[l]=arguments[l];return a=(0,f.default)(this,(e=(0,p.default)(t)).call.apply(e,[this].concat(n))),a.handleSearch=function(e){e.preventDefault();var t=a.props,r=t.onSearch,n=t.form;n.validateFieldsAndScroll(function(e,t){var a=t.createDateRange&&t.createDateRange.length&&[t.createDateRange[0].format("YYYY-MM-DD"),t.createDateRange[1].format("YYYY-MM-DD")],n={};a&&(n.beginDate=a[0],n.endDate=a[1]),Object.keys(t).forEach(function(e){"createDateRange"!==e&&(n[e]=t[e])}),n.reportId||(n.reportId=[]),n.airportId||(n.airportId=0),r(n)})},a.handleFormReset=function(){var e=a.props,t=e.form,r=e.onReset;t.resetFields(),r()},a}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.query,r=e.reports,n=e.airports;return v.default.createElement(h.default,{onSubmit:this.handleSearch,layout:"inline"},v.default.createElement(i.default,{gutter:16},v.default.createElement(d.default,{span:10},v.default.createElement(q,{label:"\u5f55\u5165\u65e5\u671f(\u8d77\u59cb)"},t("createDateRange")(v.default.createElement(I,null)))),v.default.createElement(d.default,{span:6},v.default.createElement(q,{label:"\u62a5\u8868"},t("reportId",{initialValue:a&&a.reportId?a.reportId:[]})(v.default.createElement(c.default,{placeholder:"\u8bf7\u9009\u62e9\u62a5\u8868",style:{width:180},mode:"multiple",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},r.map(function(e){return v.default.createElement(b,{key:e.id,value:e.id},e.name)}))))),v.default.createElement(d.default,{span:6},v.default.createElement(q,{label:"\u673a\u573a"},t("airportId",{initialValue:a&&a.airportId?a.airportId:void 0})(v.default.createElement(c.default,{style:{width:180},placeholder:"\u8bf7\u9009\u62e9\u673a\u573a"},n.map(function(e){return v.default.createElement(b,{key:e.id,value:e.id},e.name)})))))),v.default.createElement(i.default,{type:"flex",justify:"end"},v.default.createElement(d.default,null,v.default.createElement(l.default,{type:"primary",htmlType:"submit"},"\u67e5\u8be2")),a.beginDate&&a.endDate&&v.default.createElement(d.default,null,v.default.createElement(l.default,{style:{margin:"0 8px"},href:"/api/reports/export?".concat((0,E.stringify)(a)),target:"_blank"},"\u5bfc\u51faExcel")),v.default.createElement(d.default,null,v.default.createElement(l.default,{style:{margin:"0 8px"},onClick:this.handleFormReset},"\u91cd\u7f6e"))))}}]),t}(v.PureComponent))||m),R=D;t.default=R},qrxk:function(e,t,a){e.exports={tableList:"antd-pro-pages-report-report-history-tableList",tableListOperator:"antd-pro-pages-report-report-history-tableListOperator",tableListForm:"antd-pro-pages-report-report-history-tableListForm",submitButtons:"antd-pro-pages-report-report-history-submitButtons"}}}]);