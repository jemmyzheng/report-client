(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{Ercf:function(e,t,a){"use strict";var l=a("284h"),n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("Xi6J");var r=n(a("kl6h")),d=n(a("J4zp")),u=n(a("MVZn")),i=n(a("lwsE")),o=n(a("W8MJ")),f=n(a("a1gu")),c=n(a("Nsbk")),s=n(a("7W2i"));a("OaEy");for(var p=n(a("2fM7")),m=l(a("q1tI")),y=n(a("wd/R")),h=p.default.Option,v=[],g=1;g<32;g+=1){var E=void 0;E=g<10?"0".concat(g):"".concat(g),v.push({key:E,label:E})}var M={"01":"\u4e00","02":"\u4e8c","03":"\u4e09","04":"\u56db","05":"\u4e94","06":"\u516d","07":"\u65e5"},k=Object.keys(M).map(function(e){return{key:e,label:M[e]}}),D="HH:mm",C=function(e){function t(e){var a;(0,i.default)(this,t),a=(0,f.default)(this,(0,c.default)(t).call(this,e)),a.triggerChangeEvent=function(e){var t=e.MM,l=e.WW,n=e.DD,r=e.HH,d=e.mm,u=a.props.onChange,i="00"!==t&&"00"!==l&&"00"!==n&&"00"!==r&&"00"!==d;u&&"function"===typeof u&&u(i?"":[t,l,n,r,d].join("-"))},a.handleCtrlChange=function(e,t){"Weekly"===t&&(a.setState({WW:e}),a.triggerChangeEvent((0,u.default)({},a.state,{WW:e}))),"Monthly"===t&&(a.setState({DD:e}),a.triggerChangeEvent((0,u.default)({},a.state,{DD:e})))},a.handleTimeChange=function(e){var t=e.split(":"),l=(0,d.default)(t,2),n=l[0],r=l[1];a.setState({HH:n,mm:r}),a.triggerChangeEvent((0,u.default)({},a.state,{HH:n,mm:r}))};var l=e.value?e.value.split("-"):["00","00","00","00","00"],n=(0,d.default)(l,5),r=n[0],o=n[1],s=n[2],p=n[3],m=n[4];return a.state={MM:r,WW:o,DD:s,HH:p,mm:m,type:e.type},a}return(0,s.default)(t,e),(0,o.default)(t,[{key:"componentWillReceiveProps",value:function(e){if("value"in e){var t=e.value?e.value.split("-"):["00","00","00","00","00"],a=(0,d.default)(t,5),l=a[0],n=a[1],r=a[2],u=a[3],i=a[4];this.setState({MM:l,WW:n,DD:r,HH:u,mm:i})}"type"in e&&this.setState({type:e.type})}},{key:"render",value:function(){var e=this,t=this.state,a=t.WW,l=t.DD,n=t.HH,d=t.mm,u=t.type,i="",o=[],f="01";return"Daily"===u&&(i="\u6bcf\u65e5"),"Weekly"===u&&(i="\u6bcf\u5468",o=k,f=a),"Monthly"===u&&(i="\u6bcf\u6708",o=v,f=l),m.default.createElement("div",null,m.default.createElement("span",null,i),!!o.length&&m.default.createElement(p.default,{style:{width:80},value:f,onChange:function(t){return e.handleCtrlChange(t,u)}},o.map(function(e){return m.default.createElement(h,{key:e.key,value:e.key},e.label)})),m.default.createElement(r.default,{onChange:function(t,a){return e.handleTimeChange(a)},defaultValue:(0,y.default)("".concat(n,":").concat(d),D),format:D}))}}]),t}(m.PureComponent),w=C;t.default=w},ejrQ:function(e,t,a){"use strict";var l=a("TqRt"),n=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var r=l(a("bx4M"));a("2qtc");var d=l(a("kLXV"));a("5NDa");var u=l(a("5rEg"));a("g9YV");var i=l(a("wCAj"));a("+L6B");var o=l(a("2/Rp")),f=l(a("MVZn")),c=l(a("lwsE")),s=l(a("W8MJ")),p=l(a("a1gu")),m=l(a("Nsbk")),y=l(a("7W2i"));a("OaEy");var h=l(a("2fM7"));a("y8nQ");var v,g,E,M=l(a("Vl3Y")),k=n(a("q1tI")),D=a("MuoO"),C=a("7DNP"),w=l(a("wd/R")),W=l(a("zHco")),b=l(a("B9tY")),I=l(a("Ercf")),H=M.default.Item,q=h.default.Option,O={"01":"\u4e00","02":"\u4e8c","03":"\u4e09","04":"\u56db","05":"\u4e94","06":"\u516d","07":"\u65e5"},S=(v=(0,D.connect)(function(e){var t=e.report,a=e.dept,l=e.field,n=e.loading;return{reports:t.list,depts:a.list,fields:l.list,loading:n.models.report||n.effects["dept/queryAll"]||n.effects["field/queryAll"]}}),g=M.default.create(),v(E=g(E=function(e){function t(){var e,a;(0,c.default)(this,t);for(var l=arguments.length,n=new Array(l),r=0;r<l;r++)n[r]=arguments[r];return a=(0,p.default)(this,(e=(0,m.default)(t)).call.apply(e,[this].concat(n))),a.state={target:null,showModal:!1,type:null},a.renderDeptName=function(e){var t=a.props.depts,l=t.find(function(t){return t.id===e});return l?l.name:"not set"},a.handleAddItem=function(){a.setState({target:null,showModal:!0})},a.handleEditItem=function(e){a.setState({target:e,showModal:!0,type:e.type})},a.handleTypeChange=function(e){a.setState({type:e})},a.OKHandler=function(){var e=a.props,t=e.form.validateFields,l=e.dispatch,n=a.state.target;t(function(e,t){e||(l(n?{type:"report/edit",payload:(0,f.default)({},n,t)}:{type:"report/add",payload:(0,f.default)({},t)}),setTimeout(function(){a.setState({showModal:!1})},100))})},a}return(0,y.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.dispatch,a=e.depts,l=e.fields;t({type:"report/queryAll"}),a.length||t({type:"dept/queryAll"}),l.length||t({type:"field/queryAll"})}},{key:"render",value:function(){var e=this,t=this.props,a=t.reports,l=t.loading,n=t.depts,f=t.fields,c=t.form.getFieldDecorator,s=this.state,p=s.target,m=s.showModal,y=s.type,v=[{title:"\u62a5\u8868Id",dataIndex:"id"},{title:"\u540d\u79f0",dataIndex:"name"},{title:"\u90e8\u95e8",dataIndex:"deptId",render:this.renderDeptName},{title:"\u7c7b\u578b",dataIndex:"type",render:function(e){return"Daily"===e?"\u65e5\u62a5\u8868":"Weekly"===e?"\u5468\u62a5\u8868":"Monthly"===e?"\u6708\u62a5\u8868":"\u9b54\u6cd5\u8868"}},{title:"\u586b\u62a5\u671f\u9650",dataIndex:"deadline",render:function(e,t){var a=e.split("-"),l=t.type;return"Daily"===l?"\u6bcf\u5929".concat(a[3],"\u70b9").concat(a[4],"\u5206\u524d"):"Weekly"===l?"\u6bcf\u5468".concat(O[a[1]]).concat(a[3],"\u70b9").concat(a[4],"\u5206\u524d"):"Monthly"===l?"\u6bcf\u6708".concat(a[2],"\u65e5").concat(a[3],"\u70b9").concat(a[4],"\u5206\u524d"):"\u672a\u77e5"}},{title:"\u6dfb\u52a0\u65f6\u95f4",dataIndex:"addTime",render:function(e){return e&&k.default.createElement("span",null,(0,w.default)(e).format("YYYY-MM-DD"))}},{title:"\u6700\u8fd1\u4fee\u6539\u65f6\u95f4",dataIndex:"modifyTime",render:function(e){return e&&k.default.createElement("span",null,(0,w.default)(e).format("YYYY-MM-DD"))}},{title:"\u64cd\u4f5c",render:function(t){return t&&"Manager"!==t.role&&k.default.createElement("span",null,k.default.createElement(k.Fragment,null,k.default.createElement("a",{style:{marginRight:"10px"},onClick:function(){e.handleEditItem(t)}},"\u7f16\u8f91"),k.default.createElement(C.Link,{to:"/reports/".concat(t.id),key:t},"\u8be6\u60c5")))}}];return k.default.createElement(W.default,{title:"\u62a5\u8868\u7ba1\u7406"},k.default.createElement(r.default,{bordered:!1},k.default.createElement(o.default,{type:"dashed",onClick:this.handleAddItem,style:{width:"100%",marginBottom:8},icon:"plus"},"\u6dfb\u52a0\u65b0\u62a5\u8868"),k.default.createElement("div",{className:b.default.tableList},k.default.createElement(i.default,{rowKey:"id",loading:l,columns:v,dataSource:a})),k.default.createElement(d.default,{title:p?"\u7f16\u8f91\u7528\u6237":"\u6dfb\u52a0\u7528\u6237",visible:m,destroyOnClose:!0,maskClosable:!1,onOk:this.OKHandler,onCancel:function(){e.setState({showModal:!1})}},k.default.createElement(M.default,null,k.default.createElement(H,{label:"\u540d\u79f0"},c("name",{initialValue:p?p.name:"",rules:[{required:!0,message:"\u5fc5\u586b\u9879"}]})(k.default.createElement(u.default,null))),k.default.createElement(H,{label:"\u90e8\u95e8"},c("deptId",{initialValue:p?p.deptId:"",rules:[{required:!0,message:"\u5fc5\u586b\u9879"}]})(k.default.createElement(h.default,null,n.filter(function(e){return 0!==e.id}).map(function(e){return k.default.createElement(q,{key:e.id,value:e.id},e.name)})))),k.default.createElement(H,{label:"\u62a5\u8868\u7c7b\u578b"},c("type",{initialValue:p?p.type:"",rules:[{required:!0,message:"\u5fc5\u586b\u9879"}]})(k.default.createElement(h.default,{onChange:this.handleTypeChange},k.default.createElement(q,{value:"Daily"},"\u65e5\u62a5\u8868"),k.default.createElement(q,{value:"Weekly"},"\u5468\u62a5\u8868"),k.default.createElement(q,{value:"Monthly"},"\u6708\u62a5\u8868")))),k.default.createElement(H,{label:"\u586b\u62a5\u671f\u9650"},c("deadline",{initialValue:p?p.deadline:"",rules:[{required:!0,message:"\u5fc5\u586b\u9879"}]})(k.default.createElement(I.default,{type:y||"Daily"}))),!p&&k.default.createElement(H,{label:"\u5b57\u6bb5"},c("fields",{rules:[{required:!0,message:"\u81f3\u5c11\u8981\u9009\u4e00\u4e2a\u5b57\u6bb5!",type:"array"}]})(k.default.createElement(h.default,{showSearch:!0,mode:"multiple",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},f.map(function(e){return k.default.createElement(q,{key:e.id,value:e.id},e.name)}))))))))}}]),t}(k.PureComponent))||E)||E),Y=S;t.default=Y}}]);